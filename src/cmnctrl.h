//==========================================================
// cmnctrl.h
//==========================================================
// 汎用機能の提供
// ---------------------------------------------------------
// 依存関係 :
// ・resource.h  [子]
// ・cmdproc.h   [親]
// ・storectrl.h [親]
//==========================================================


#ifndef _CMNCTRL_H_
#define _CMNCTRL_H_

#define STRICT
#define WIN32_LEAN_AND_MEAN


/* Windows32 API Header */
#include <windows.h>
#include <tchar.h>

/* Standard API Header */
#include <stdio.h>
#include <stdlib.h>

/* Other API & Resource Header */
#include "resource.h"

//==========================================================
// 各種マクロ
//==========================================================
#define MAX_RESUME_PROMPT 50	//プロンプトの最大履歴数


//==========================================================
// LPCTSTR 用 strtok 関数改造版
//==========================================================
LPTSTR lptstrtok(LPCTSTR, LPTSTR*, const TCHAR, int, int*);
// ---------------------------------------------------------
// arg1 : 分割対象文字列
// arg2 : トークン格納配列へのポインタ
// arg3 : 分割に使う文字
// arg4 : 最大トークン生成数
// arg5 : トークン数格納変数へのポインタ
// ---------------------------------------------------------
// rev	: 内部で動的に確保した領域のポインタ(失敗時はNULL)
//		: ※必ず使用側で開放すること。
//==========================================================

//==========================================================
// 文字列検査関数 ('0'～'9'のみかチェック)
//==========================================================
BOOL IsNumeric(LPCTSTR);
// ---------------------------------------------------------
// arg1 : 検査対象文字列
// ---------------------------------------------------------
// rev	: 構成要素が数字のみならTRUE、そうでなければFALES
//==========================================================

//==========================================================
// ログ書き出し関数
//==========================================================
void WriteLog(HANDLE, LPCTSTR);
// ---------------------------------------------------------
// arg1 : ファイルハンドル
// arg2 : 書き込み対象文字列
//		: 自動で改行されるので'\n'は不用
//==========================================================

//==========================================================
// プロンプト制御関数
//==========================================================
void WritePrompt(HWND, LPCTSTR);
// ---------------------------------------------------------
// arg1 : ダイアログウィンドウハンドル
// arg2 : 表示対象文字列
//==========================================================

//==========================================================
// タイムフォーマットチェック関数
//==========================================================
BOOL TimeFormatCheck(int, int, int, int, int);
// ---------------------------------------------------------
// arg1 : Year
// arg2 : Month
// arg3 : Day
// arg4 : Hour
// arg5 : Minit
// ---------------------------------------------------------
// rev 	: 無効な日付や時刻が与えられていなければTRUE、
//		: 与えられていればFALSE
//==========================================================

//==========================================================
// タイムフォーマット数値化関数
//==========================================================
double TimeToNum(int, int, int, int);
// ---------------------------------------------------------
// arg1 : Month
// arg2 : Day
// arg3 : Hour
// arg4 : Minit
// ---------------------------------------------------------
// rev	: 月換算した各引数の和
//==========================================================

#endif